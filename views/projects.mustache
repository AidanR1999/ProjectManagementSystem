{{>header}}

<head>
    <!--Bootstrap dependencies-->
    {{! <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet" id="bootstrap-css"> }}
    <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
    <script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
    <!--Font Awesome 5-->
    <script src="https://kit.fontawesome.com/2cf49272b2.js" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.6.0/Sortable.js"></script>
</head>
<div class="container">
    <div class="row">
        <h1>My Projects</h1>
    </div>
</div>

<div class="container">
    <div class="row">
        <div class="span2">
            <a href="/project/create">
                <p>Create new Project</p>
            </a>
        </div>
    </div>
</div>
<ul id="myTab" class="nav nav-tabs">
        <li class="nav-item">
            <a href="#incomplete" class="nav-link active" data-toggle="tab">Incomplete Projects</a>
        </li>
        <li class="nav-item">
            <a href="#complete" class="nav-link" data-toggle="tab">Complete Projects</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade show active" id="incomplete">
    <ul style="list-style-type:none;" id="items">
    {{#incompleteProjects}}
        <li>
            <div class="container">
                <div class="row">
                    <div class="container well span6">
                        <div class="col-sm"></div>
                        <div class="row-fluid">
                            <div class="span1">
                                <i class="fas fa-bars"></i>
                            </div>
                            
                            <div class="span9">
                                <a href="/project/edit/{{_id}}">
                                    <h3>{{title}}</h3>
                                </a>
                                <label>Module:</label>
                                <h6>{{module}}</h6>
                                <label>Due Date:</label>
                                <h6>{{dueDate}}</h6>
                                <label>Completion Date:</label>
                                <h6>{{completionDate}}</h6>
                            </div>
                            
                            <div class="span2">
                            <!-- <button type="button" class="btn btn-danger" data-id={{_id}} data-toggle="modal" data-target="#deleteModal">
                                    Delete
                                </button>
                                -->
                                <form action="/project/complete/{{_id}}" method="post" >
                                    <input type="hidden" id="id" name="id" value="{{_id}}">
                                    <button type="submit" class="btn btn-success">
                                        Complete
                                    </button>
                                </form>
                                <form action="/project/delete/{{_id}}" method="post" >
                                    <input type="hidden" id="id" name="id" value="{{_id}}">
                                        <button type="submit" class="btn btn-danger">
                                            <span class="icon-trash"></span> Delete</a>
                                        </button>
                                </form>
                                <!-- Delete confirmation Modal -->
                                <!-- 
                                <form action="/project/delete/{{_id}}" method="post" >
                                <div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel" aria-hidden="true">
                                <div class="modal-dialog" role="document">
                                    <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="deleteModalLabel">Delete Project</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        
                                        <label>Are you sure you want to delete this project {{title}}</label>
                                        
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                        <input type="hidden" id="id" name="id" value="{{_id}}">
                                        <button type="submit" class="btn btn-danger">
                                                <span class="icon-trash"></span> Delete</a>
                                            </button>
                                    </div>
                                    </div>
                                </div>
                                </div>
                            </form>
                                -->
                            </div>
                        </div>
                        <div class="col-sm"></div>
                    </div>
                </div>
            </div>
        </li>
        
{{/incompleteProjects}}
</ul>
    </div>
    <div class="tab-pane fade" id="complete">
    <ul style="list-style-type:none;" id="items">
    {{#completeProjects}}
        <li>
            <div class="container">
                <div class="row">
                    <div class="container well span6">
                        <div class="col-sm"></div>
                        <div class="row-fluid">
                            <div class="span1">
                                <i class="fas fa-bars"></i>
                            </div>
                            
                            <div class="span9">
                                <a href="/project/edit/{{_id}}">
                                    <h3>{{title}}</h3>
                                </a>
                                <label>Module:</label>
                                <h6>{{module}}</h6>
                                <label>Due Date:</label>
                                <h6>{{dueDate}}</h6>
                                <label>Completion Date:</label>
                                <h6>{{completionDate}}</h6>
                            </div>
                            
                            <div class="span2">
                            <!-- <button type="button" class="btn btn-danger" data-id={{_id}} data-toggle="modal" data-target="#deleteModal">
                                    Delete
                                </button>
                                -->
                                
                                <form action="/project/delete/{{_id}}" method="post" >
                                    <input type="hidden" id="id" name="id" value="{{_id}}">
                                        <button type="submit" class="btn btn-danger">
                                            <span class="icon-trash"></span> Delete</a>
                                        </button>
                                </form>
                                <!-- Delete confirmation Modal -->
                                <!-- 
                                <form action="/project/delete/{{_id}}" method="post" >
                                <div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel" aria-hidden="true">
                                <div class="modal-dialog" role="document">
                                    <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="deleteModalLabel">Delete Project</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        
                                        <label>Are you sure you want to delete this project {{title}}</label>
                                        
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                        <input type="hidden" id="id" name="id" value="{{_id}}">
                                        <button type="submit" class="btn btn-danger">
                                                <span class="icon-trash"></span> Delete</a>
                                            </button>
                                    </div>
                                    </div>
                                </div>
                                </div>
                            </form>
                                -->
                            </div>
                        </div>
                        <div class="col-sm"></div>
                    </div>
                </div>
            </div>
        </li>
        
{{/completeProjects}}
</ul>
    </div>
</div>



<script>
    // Sorting project order
    window.addEventListener('load', function() {
    var el = document.getElementById('items');
    var sortable = Sortable.create(el, {
    handle: '.fas.fa-bars', // handle's class
    group: "items",
    ghostClass: "sortable-ghost",

    // storing and updating order and saving to local storage
    store: {
        get: function(sortable) {
            var order = localStorage.getItem(sortable.options.group.name);
			return order ? order.split('|') : [];
        },

        set: function (sortable) {
			var order = sortable.toArray();
            localStorage.setItem(sortable.options.group.name, order.join('|'));
            console.log(order);
		}  

    }
    });
    })


</script>

{{>footer}}