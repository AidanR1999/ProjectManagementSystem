{{>header}}

<head>
    <!--Bootstrap dependencies-->
    <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet" id="bootstrap-css">
    <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
    <script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
    <!--Font Awesome 5-->
    <script src="https://kit.fontawesome.com/2cf49272b2.js" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.6.0/Sortable.js"></script>
</head>
<div class="container">
    <div class="row">
        <h1>My Projects</h1>
    </div>
</div>

<div class="container">
    <div class="row">
        <div class="span2">
            <a href="/project/create">
                <p>Create new Project</p>
            </a>
        </div>
    </div>
</div>
<ul style="list-style-type:none;" id="items">
    {{#projects}}
        <li>
            <div class="container">
                <div class="row">
                    <div class="container well span6">
                        <div class="col-sm"></div>
                        <div class="row-fluid">
                            <div class="span1">
                                <i class="fas fa-bars"></i>
                            </div>
                            
                            <div class="span9">
                                <a href="/project/edit/{{_id}}">
                                    <h3>{{title}}</h3>
                                </a>
                                <h6>{{module}}</h6>
                                <h6>{{dueDate}}</h6>
                            </div>
                            
                            <div class="span2">
                                <form action="/project/delete" method="post" >
                                    <input type="hidden" id="id" name="id" value="{{_id}}">
                                    <button type="submit" class="btn btn-danger">
                                        <span class="icon-trash"></span> Delete</a>
                                    </button>
                                </form>
                            </div>
                        </div>
                        <div class="col-sm"></div>
                    </div>
                </div>
            </div>
        </li>
    
{{/projects}}
</ul>

<script>
    // Sorting project order
    window.addEventListener('load', function() {
    var el = document.getElementById('items');
    var sortable = Sortable.create(el, {
    handle: '.fas.fa-bars', // handle's class
    group: "items",
    ghostClass: "sortable-ghost",
    // storing and updating order and saving to local storage
    store: {
        get: function(sortable) {
            var order = localStorage.getItem(sortable.options.group.name);
			return order ? order.split('|') : [];
        },

        set: function (sortable) {
			var order = sortable.toArray();
			localStorage.setItem(sortable.options.group.name, order.join('|'));
		}
    }
    });
    })
    

</script>

{{>footer}}